C51 COMPILER V9.00   LCD                                                                   05/08/2013 16:47:36 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE LCD
OBJECT MODULE PLACED IN .\Build\LCD.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE display\LCD.c LARGE OMF2 ROM(D16M) BROWSE INTVECTOR(0X6020) INCDIR(..\SRC\F
                    -reeRTOSSource\include\;..\SRC\FreeRTOSSource\portable\Keil\AX11000;..\SRC\CPU\;..\SRC\MS_TIMER\;..\SRC\SW_DMA\;..\SRC\UA
                    -RT\;..\SRC\ETHERNET\;..\SRC\APPLICATION\;..\SRC\ETHERNET\;..\SRC\tcpip\;..\SRC\ADAPTER;..\SRC\main;..\SRC\SD_Card\;..\SR
                    -C\GSM\;..\SRC\Web\;..\SRC\SPI\;..\SRC\I2C\;..\SRC\PCA\;..\SRC\Modbus\;..\SRC\buffer\;..\SRC\hsur\;..\SRC\management\;..\
                    -SRC\dhcp\;..\SRC\pppoe\;..\SRC\flash;..\SRC\SNTP;..\SRC\display;..\SRC\key;..\SRC\schedule;..\SRC\program;..\SRC\Scan) D
                    -EFINE(KEIL_AX11000) VARBANKING DEBUG PRINT(.\Build\LCD.lst) OBJECT(.\Build\LCD.obj)

line level    source

   1          #include "main.h"
   2          #include "lcd.h"
   3          #include  <intrins.h> 
   4          #include <string.h>
   5          #include <ctype.h>   
   6          #include "si2c.h"
   7          
   8          
   9          
  10          unsigned char const code aby_Char_Table[10] = {'0','1','2','3','4','5','6','7','8','9'};
  11          
  12          /*(0) !(1) "(2) #(3) $(4) %(5) &(6) '(7) ((8) )(9) *(10) +(11) ,(12) -(13) .(14) /(15)
  13           0(16) 1(17) 2(18) 3(19) 4(20) 5(21) 6(22) 7(23) 8(24) 9(25) :(26) ;(27) <(28) =(29) >(30) ?(31)
  14           @(32) A(33) B(34) C(35) D(36) E(37) F(38) G(39) H(40) I(41) J(42) K(43) L(44) M(45) N(46) O(47)
  15           P(48) Q(49) R(50) S(51) T(52) U(53) V(54) W(55) X(56) Y(57) Z(58) [(59) \(60) ](61) ^(62) _(63)
  16           `(64) a(65) b(66) c(67) d(68) e(69) f(70) g(71) h(72) i(73) j(74) k(75) l(76) m(77) n(78) o(79)
  17           p(80) q(81) r(82) s(83) t(84) u(85) v(86) w(87) x(88) y(89) z(90) {(91) |(92) }(93) ~(94) |(95)*/ 
  18          
  19          
  20          
  21          
  22          unsigned char const code Dot8_16[95][2][8] = 
  23          {
  24                  {
  25                          {0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF},
  26                          {0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF},/*" ",0*/
  27                  },
  28                  {
  29                          {0xFF,0xFF,0xFF,0x03,0xFF,0xFF,0xFF,0xFF},
  30                          {0xFF,0xFF,0xFF,0xF3,0xFF,0xFF,0xFF,0xFF},/*"!",1*/
  31                  },
  32                  {
  33                          {0xFF,0xEF,0xF3,0xEF,0xF3,0xFF,0xFF,0xFF},
  34                          {0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF},/*""",2*/
  35                  },
  36                  {
  37                          {0xFF,0xEF,0x03,0xEF,0x03,0xEF,0xFF,0xFF},
  38                          {0xFF,0xFB,0xE0,0xFB,0xE0,0xFB,0xFF,0xFF},/*"#",3*/
  39                  },
  40                  {
  41                          {0xFF,0xCF,0xB7,0x03,0x77,0xCF,0xFF,0xFF},
  42                          {0xFF,0xF9,0xF7,0xE0,0xF7,0xF8,0xFF,0xFF},/*"$",4*/
  43                  },
  44                  {
  45                          {0xFF,0xE7,0xDB,0x27,0xCF,0xF3,0xFF,0xFF},
  46                          {0xFF,0xF3,0xFC,0xF9,0xF6,0xF9,0xFF,0xFF},/*"%",5*/
  47                  },
  48                  {
  49                          {0xFF,0x67,0x9B,0x67,0xFF,0x7F,0xFF,0xFF},
  50                          {0xFF,0xF8,0xF7,0xF6,0xF9,0xF6,0xFF,0xFF},/*"&",6*/
C51 COMPILER V9.00   LCD                                                                   05/08/2013 16:47:36 PAGE 2   

  51                  },
  52                  {
  53                          {0xFF,0xFF,0xEB,0xF3,0xFF,0xFF,0xFF,0xFF},
  54                          {0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF},/*"'",7*/
  55                  },
  56                  {
  57                          {0xFF,0xFF,0x1F,0xE7,0xFB,0xFF,0xFF,0xFF},
  58                          {0xFF,0xFF,0xFC,0xF3,0xEF,0xFF,0xFF,0xFF},/*"(",8*/
  59                  },
  60                  {
  61                          {0xFF,0xFF,0xFB,0xE7,0x1F,0xFF,0xFF,0xFF},
  62                          {0xFF,0xFF,0xEF,0xF3,0xFC,0xFF,0xFF,0xFF},/*")",9*/
  63                  },
  64                  {
  65                          {0xFF,0x9F,0x7F,0x0F,0x7F,0x9F,0xFF,0xFF},
  66                          {0xFF,0xFC,0xFF,0xF8,0xFF,0xFC,0xFF,0xFF},/*"*",10*/
  67                  },
  68                  {
  69                          {0xFF,0x7F,0x7F,0x0F,0x7F,0x7F,0xFF,0xFF},
  70                          {0xFF,0xFF,0xFF,0xF8,0xFF,0xFF,0xFF,0xFF},/*"+",11*/
  71                  },
  72                  {
  73                          {0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF},
  74                          {0xFF,0xFF,0xEB,0xF3,0xFF,0xFF,0xFF,0xFF},/*",",12*/
  75                  },
  76                  {
  77                          {0xFF,0x7F,0x7F,0x7F,0x7F,0xFF,0xFF,0xFF},
  78                          {0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF},/*"-",13*/
  79                  },
  80                  {
  81                          {0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF},
  82                          {0xFF,0xFF,0xF3,0xF3,0xFF,0xFF,0xFF,0xFF},/*".",14*/
  83                  },
  84                  {
  85                          {0xFF,0xFF,0xFF,0x3F,0xCF,0xF3,0xFF,0xFF},
  86                          {0xFF,0xE7,0xF9,0xFE,0xFF,0xFF,0xFF,0xFF},/*"/",15*/
  87                  },
  88                  {
  89                          {0xFF,0x0F,0xF7,0xF7,0x0F,0xFF,0xFF,0xFF},
  90                          {0xFF,0xF8,0xF7,0xF7,0xF8,0xFF,0xFF,0xFF},/*"0",16*/
  91                  },
  92                  {
  93                          {0xFF,0xFF,0xEF,0x07,0xFF,0xFF,0xFF,0xFF},
  94                          {0xFF,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xFF},/*"1",17*/
  95                  },
  96                  {
  97                          {0xFF,0xCF,0xF7,0x77,0x8F,0xFF,0xFF,0xFF},
  98                          {0xFF,0xF3,0xF4,0xF7,0xF7,0xFF,0xFF,0xFF},/*"2",18*/
  99                  },
 100                  {
 101                          {0xFF,0xCF,0x77,0x77,0x8F,0xFF,0xFF,0xFF},
 102                          {0xFF,0xF9,0xF7,0xF7,0xF8,0xFF,0xFF,0xFF},/*"3",19*/
 103                  },
 104                  {
 105                          {0xFF,0xFF,0x3F,0xCF,0x07,0xFF,0xFF,0xFF},
 106                          {0xFF,0xFC,0xFD,0xFD,0xF0,0xFD,0xFF,0xFF},/*"4",20*/
 107                  },
 108                  {
 109                          {0xFF,0x07,0xB7,0xB7,0x77,0xFF,0xFF,0xFF},
 110                          {0xFF,0xF9,0xF7,0xF7,0xF8,0xFF,0xFF,0xFF},/*"5",21*/
 111                  },
 112                  {
C51 COMPILER V9.00   LCD                                                                   05/08/2013 16:47:36 PAGE 3   

 113                          {0xFF,0x0F,0x77,0x77,0xCF,0xFF,0xFF,0xFF},
 114                          {0xFF,0xF8,0xF7,0xF7,0xF8,0xFF,0xFF,0xFF},/*"6",22*/
 115                  },
 116                  {
 117                          {0xFF,0xF7,0xF7,0x37,0xC7,0xFF,0xFF,0xFF},
 118                          {0xFF,0xFF,0xF1,0xFE,0xFF,0xFF,0xFF,0xFF},/*"7",23*/
 119                  },
 120                  {
 121                          {0xFF,0x8F,0x77,0x77,0x8F,0xFF,0xFF,0xFF},
 122                          {0xFF,0xF8,0xF7,0xF7,0xF8,0xFF,0xFF,0xFF},/*"8",24*/
 123                  },
 124                  {
 125                          {0xFF,0x8F,0x77,0x77,0x0F,0xFF,0xFF,0xFF},
 126                          {0xFF,0xF9,0xF7,0xF7,0xF8,0xFF,0xFF,0xFF},/*"9",25*/
 127                  },
 128                  {
 129                          {0xFF,0xFF,0x9F,0x9F,0xFF,0xFF,0xFF,0xFF},
 130                          {0xFF,0xFF,0xF3,0xF3,0xFF,0xFF,0xFF,0xFF},/*":",26*/
 131                  },
 132                  {
 133                          {0xFF,0xFF,0x9F,0x9F,0xFF,0xFF,0xFF,0xFF},
 134                          {0xFF,0xFF,0xEB,0xF3,0xFF,0xFF,0xFF,0xFF},/*";",27*/
 135                  },
 136                  {
 137                          {0xFF,0x7F,0xBF,0xDF,0xEF,0xF7,0xFF,0xFF},
 138                          {0xFF,0xFF,0xFE,0xFD,0xFB,0xF7,0xFF,0xFF},/*"<",28*/
 139                  },
 140                  {
 141                          {0xFF,0xDF,0xDF,0xDF,0xDF,0xFF,0xFF,0xFF},
 142                          {0xFF,0xFE,0xFE,0xFE,0xFE,0xFF,0xFF,0xFF},/*"=",29*/
 143                  },
 144                  {
 145                          {0xFF,0xF7,0xEF,0xDF,0xBF,0x7F,0xFF,0xFF},
 146                          {0xFF,0xF7,0xFB,0xFD,0xFE,0xFF,0xFF,0xFF},/*">",30*/
 147                  },
 148                  {
 149                          {0xFF,0xCF,0xF7,0x77,0x8F,0xFF,0xFF,0xFF},
 150                          {0xFF,0xFF,0xFF,0xF2,0xFF,0xFF,0xFF,0xFF},/*"?",31*/
 151                  },
 152                  {
 153                          {0xFF,0x0F,0xD7,0x17,0xF7,0x0F,0xFF,0xFF},
 154                          {0xFF,0xF8,0xF6,0xF6,0xF5,0xFA,0xFF,0xFF},/*"@",32*/
 155                  },
 156                  {
 157                          {0xFF,0xFF,0x1F,0xE7,0x1F,0xFF,0xFF,0xFF},
 158                          {0xFF,0xF0,0xFD,0xFD,0xFD,0xF0,0xFF,0xFF},/*"A",33*/
 159                  },
 160                  {
 161                          {0xFF,0x07,0x77,0x77,0x77,0x8F,0xFF,0xFF},
 162                          {0xFF,0xF0,0xF7,0xF7,0xF7,0xF8,0xFF,0xFF},/*"B",34*/
 163                  },
 164                  {
 165                          {0xFF,0x0F,0xF7,0xF7,0xF7,0xCF,0xFF,0xFF},
 166                          {0xFF,0xF8,0xF7,0xF7,0xF7,0xF9,0xFF,0xFF},/*"C",35*/
 167                  },
 168                  {
 169                          {0xFF,0x07,0xF7,0xF7,0xEF,0x1F,0xFF,0xFF},
 170                          {0xFF,0xF0,0xF7,0xF7,0xFB,0xFC,0xFF,0xFF},/*"D",36*/
 171                  },
 172                  {
 173                          {0xFF,0x07,0x77,0x77,0x77,0xF7,0xFF,0xFF},
 174                          {0xFF,0xF0,0xF7,0xF7,0xF7,0xF7,0xFF,0xFF},/*"E",37*/
C51 COMPILER V9.00   LCD                                                                   05/08/2013 16:47:36 PAGE 4   

 175                  },
 176                  {
 177                          {0xFF,0x07,0x77,0x77,0x77,0xF7,0xFF,0xFF},
 178                          {0xFF,0xF0,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF},/*"F",38*/
 179                  },
 180                  {
 181                          {0xFF,0x0F,0xF7,0xF7,0xF7,0xCF,0xFF,0xFF},
 182                          {0xFF,0xF8,0xF7,0xF7,0xFA,0xF0,0xFF,0xFF},/*"G",39*/
 183                  },
 184                  {
 185                          {0xFF,0x07,0x7F,0x7F,0x7F,0x07,0xFF,0xFF},
 186                          {0xFF,0xF0,0xFF,0xFF,0xFF,0xF0,0xFF,0xFF},/*"H",40*/
 187                  },
 188                  {
 189                          {0xFF,0xFF,0xF7,0x07,0xF7,0xFF,0xFF,0xFF},
 190                          {0xFF,0xFF,0xF7,0xF0,0xF7,0xFF,0xFF,0xFF},/*"I",41*/
 191                  },
 192                  {
 193                          {0xFF,0xFF,0xFF,0xFF,0x07,0xFF,0xFF,0xFF},
 194                          {0xFF,0xF9,0xF7,0xF7,0xF8,0xFF,0xFF,0xFF},/*"J",42*/
 195                  },
 196                  {
 197                          {0xFF,0x07,0x7F,0x9F,0xE7,0xFF,0xFF,0xFF},
 198                          {0xFF,0xF0,0xFF,0xFC,0xF3,0xFF,0xFF,0xFF},/*"K",43*/
 199                  },
 200                  {
 201                          {0xFF,0x07,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF},
 202                          {0xFF,0xF0,0xF7,0xF7,0xF7,0xF7,0xFF,0xFF},/*"L",44*/
 203                  },
 204                  {
 205                          {0xFF,0x07,0x1F,0xFF,0x1F,0x07,0xFF,0xFF},
 206                          {0xFF,0xF0,0xFF,0xF0,0xFF,0xF0,0xFF,0xFF},/*"M",45*/
 207                  },
 208                  {
 209                          {0xFF,0x07,0xCF,0x3F,0xFF,0x07,0xFF,0xFF},
 210                          {0xFF,0xF0,0xFF,0xFE,0xF9,0xF0,0xFF,0xFF},/*"N",46*/
 211                  },
 212                  {
 213                          {0xFF,0x0F,0xF7,0xF7,0xF7,0x0F,0xFF,0xFF},
 214                          {0xFF,0xF8,0xF7,0xF7,0xF7,0xF8,0xFF,0xFF},/*"O",47*/
 215                  },
 216                  {
 217                          {0xFF,0x07,0x77,0x77,0x77,0x8F,0xFF,0xFF},
 218                          {0xFF,0xF0,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF},/*"P",48*/
 219                  },
 220                  {
 221                          {0xFF,0x0F,0xF7,0xF7,0xF7,0x0F,0xFF,0xFF},
 222                          {0xFF,0xF8,0xF7,0xF5,0xFB,0xF4,0xFF,0xFF},/*"Q",49*/
 223                  },
 224                  {
 225                          {0xFF,0x07,0x77,0x77,0x77,0x8F,0xFF,0xFF},
 226                          {0xFF,0xF0,0xFF,0xFF,0xFE,0xF1,0xFF,0xFF},/*"R",50*/
 227                  },
 228                  {
 229                          {0xFF,0xCF,0xB7,0x77,0xF7,0xCF,0xFF,0xFF},
 230                          {0xFF,0xF9,0xF7,0xF7,0xF6,0xF9,0xFF,0xFF},/*"S",51*/
 231                  },
 232                  {
 233                          {0xFF,0xF7,0xF7,0x07,0xF7,0xF7,0xFF,0xFF},
 234                          {0xFF,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xFF},/*"T",52*/
 235                  },
 236                  {
C51 COMPILER V9.00   LCD                                                                   05/08/2013 16:47:36 PAGE 5   

 237                          {0xFF,0x07,0xFF,0xFF,0xFF,0x07,0xFF,0xFF},
 238                          {0xFF,0xF8,0xF7,0xF7,0xF7,0xF8,0xFF,0xFF},/*"U",53*/
 239                  },
 240                  {
 241                          {0xFF,0xC7,0x3F,0xFF,0x3F,0xC7,0xFF,0xFF},
 242                          {0xFF,0xFF,0xFE,0xF1,0xFE,0xFF,0xFF,0xFF},/*"V",54*/
 243                  },
 244                  {
 245                          {0xFF,0x07,0xFF,0x07,0xFF,0x07,0xFF,0xFF},
 246                          {0xFF,0xFF,0xF0,0xFF,0xF0,0xFF,0xFF,0xFF},/*"W",55*/
 247                  },
 248                  {
 249                          {0xFF,0xE7,0x9F,0x7F,0x9F,0xE7,0xFF,0xFF},
 250                          {0xFF,0xF3,0xFC,0xFF,0xFC,0xF3,0xFF,0xFF},/*"X",56*/
 251                  },
 252                  {
 253                          {0xFF,0xE7,0x9F,0x7F,0x9F,0xE7,0xFF,0xFF},
 254                          {0xFF,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xFF},/*"Y",57*/
 255                  },
 256                  {
 257                          {0xFF,0xF7,0xF7,0x77,0x97,0xE7,0xFF,0xFF},
 258                          {0xFF,0xF3,0xF4,0xF7,0xF7,0xF7,0xFF,0xFF},/*"Z",58*/
 259                  },
 260                  {
 261                          {0xFF,0xFF,0xFF,0x03,0xFB,0xFB,0xFF,0xFF},
 262                          {0xFF,0xFF,0xFF,0xE0,0xEF,0xEF,0xFF,0xFF},/*"[",59*/
 263                  },
 264                  {
 265                          {0xFF,0xF3,0xCF,0x3F,0xFF,0xFF,0xFF,0xFF},
 266                          {0xFF,0xFF,0xFF,0xFE,0xF9,0xE7,0xFF,0xFF},/*"\",60*/
 267                  },
 268                  {
 269                          {0xFF,0xFB,0xFB,0x03,0xFF,0xFF,0xFF,0xFF},
 270                          {0xFF,0xEF,0xEF,0xE0,0xFF,0xFF,0xFF,0xFF},/*"]",61*/
 271                  },
 272                  {
 273                          {0xFF,0xFF,0xF7,0xFB,0xF7,0xFF,0xFF,0xFF},
 274                          {0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF},/*"^",62*/
 275                  },
 276                  {
 277                          {0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF},
 278                          {0xEF,0xEF,0xEF,0xEF,0xEF,0xEF,0xFF,0xFF},/*"_",63*/
 279                  },
 280                  {
 281                          {0xFF,0xFF,0xFB,0xF7,0xFF,0xFF,0xFF,0xFF},
 282                          {0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF},/*"`",64*/
 283                  },
 284                  {
 285                          {0xFF,0x7F,0xBF,0xBF,0x7F,0xFF,0xFF,0xFF},
 286                          {0xFF,0xF9,0xF6,0xF6,0xF8,0xF7,0xFF,0xFF},/*"a",65*/
 287                  },
 288                  {
 289                          {0xFF,0x07,0xBF,0xBF,0xBF,0x7F,0xFF,0xFF},
 290                          {0xFF,0xF0,0xF7,0xF7,0xF7,0xF8,0xFF,0xFF},/*"b",66*/
 291                  },
 292                  {
 293                          {0xFF,0x7F,0xBF,0xBF,0xBF,0x7F,0xFF,0xFF},
 294                          {0xFF,0xF8,0xF7,0xF7,0xF7,0xFB,0xFF,0xFF},/*"c",67*/
 295                  },
 296                  {
 297                          {0xFF,0x7F,0xBF,0xBF,0xBF,0x07,0xFF,0xFF},
 298                          {0xFF,0xF8,0xF7,0xF7,0xF7,0xF0,0xFF,0xFF},/*"d",68*/
C51 COMPILER V9.00   LCD                                                                   05/08/2013 16:47:36 PAGE 6   

 299                  },
 300                  {
 301                          {0xFF,0x7F,0xBF,0xBF,0xBF,0x7F,0xFF,0xFF},
 302                          {0xFF,0xF8,0xF6,0xF6,0xF6,0xFA,0xFF,0xFF},/*"e",69*/
 303                  },
 304                  {
 305                          {0xFF,0xBF,0x0F,0xB7,0xF7,0xFF,0xFF,0xFF},
 306                          {0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xFF,0xFF},/*"f",70*/
 307                  },
 308                  {
 309                          {0xFF,0x7F,0xBF,0xBF,0x7F,0xBF,0xFF,0xFF},
 310                          {0xFF,0xF5,0xEA,0xEA,0xEB,0xF7,0xFF,0xFF},/*"g",71*/
 311                  },
 312                  {
 313                          {0xFF,0x07,0xBF,0xBF,0xBF,0x7F,0xFF,0xFF},
 314                          {0xFF,0xF0,0xFF,0xFF,0xFF,0xF0,0xFF,0xFF},/*"h",72*/
 315                  },
 316                  {
 317                          {0xFF,0xFF,0xFF,0x27,0xFF,0xFF,0xFF,0xFF},
 318                          {0xFF,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xFF},/*"i",73*/
 319                  },
 320                  {
 321                          {0xFF,0xFF,0xFF,0x27,0xFF,0xFF,0xFF,0xFF},
 322                          {0xFF,0xEF,0xEF,0xF0,0xFF,0xFF,0xFF,0xFF},/*"j",74*/
 323                  },
 324                  {
 325                          {0xFF,0x07,0xFF,0xFF,0x7F,0xBF,0xFF,0xFF},
 326                          {0xFF,0xF0,0xFD,0xFC,0xFB,0xF7,0xFF,0xFF},/*"k",75*/
 327                  },
 328                  {
 329                          {0xFF,0xFF,0xFF,0x07,0xFF,0xFF,0xFF,0xFF},
 330                          {0xFF,0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xFF},/*"l",76*/
 331                  },
 332                  {
 333                          {0xFF,0x3F,0xBF,0x7F,0xBF,0x7F,0xFF,0xFF},
 334                          {0xFF,0xF0,0xFF,0xF0,0xFF,0xF0,0xFF,0xFF},/*"m",77*/
 335                  },
 336                  {
 337                          {0xFF,0x3F,0xBF,0xBF,0xBF,0x7F,0xFF,0xFF},
 338                          {0xFF,0xF0,0xFF,0xFF,0xFF,0xF0,0xFF,0xFF},/*"n",78*/
 339                  },
 340                  {
 341                          {0xFF,0x7F,0xBF,0xBF,0xBF,0x7F,0xFF,0xFF},
 342                          {0xFF,0xF8,0xF7,0xF7,0xF7,0xF8,0xFF,0xFF},/*"o",79*/
 343                  },
 344                  {
 345                          {0xFF,0x3F,0xBF,0xBF,0xBF,0x7F,0xFF,0xFF},
 346                          {0xFF,0xE0,0xFB,0xFB,0xFB,0xFC,0xFF,0xFF},/*"p",80*/
 347                  },
 348                  {
 349                          {0xFF,0x7F,0xBF,0xBF,0xBF,0x3F,0xFF,0xFF},
 350                          {0xFF,0xFC,0xFB,0xFB,0xFB,0xE0,0xFF,0xFF},/*"q",81*/
 351                  },
 352                  {
 353                          {0xFF,0xFF,0x3F,0x7F,0xBF,0xBF,0xFF,0xFF},
 354                          {0xFF,0xFF,0xF0,0xFF,0xFF,0xFF,0xFF,0xFF},/*"r",82*/
 355                  },
 356                  {
 357                          {0xFF,0x7F,0xBF,0xBF,0xBF,0x7F,0xFF,0xFF},
 358                          {0xFF,0xFB,0xF6,0xF6,0xF5,0xFB,0xFF,0xFF},/*"s",83*/
 359                  },
 360                  {
C51 COMPILER V9.00   LCD                                                                   05/08/2013 16:47:36 PAGE 7   

 361                          {0xFF,0xBF,0x07,0xBF,0xFF,0xFF,0xFF,0xFF},
 362                          {0xFF,0xFF,0xF8,0xF7,0xF7,0xFF,0xFF,0xFF},/*"t",84*/
 363                  },
 364                  {
 365                          {0xFF,0x3F,0xFF,0xFF,0xFF,0x3F,0xFF,0xFF},
 366                          {0xFF,0xF8,0xF7,0xF7,0xF7,0xF0,0xFF,0xFF},/*"u",85*/
 367                  },
 368                  {
 369                          {0xFF,0x3F,0xFF,0xFF,0xFF,0x3F,0xFF,0xFF},
 370                          {0xFF,0xFF,0xFC,0xF3,0xFC,0xFF,0xFF,0xFF},/*"v",86*/
 371                  },
 372                  {
 373                          {0xFF,0x3F,0xFF,0x3F,0xFF,0x3F,0xFF,0xFF},
 374                          {0xFF,0xFE,0xF1,0xFE,0xF1,0xFE,0xFF,0xFF},/*"w",87*/
 375                  },
 376                  {
 377                          {0xFF,0xBF,0x7F,0xFF,0x7F,0xBF,0xFF,0xFF},
 378                          {0xFF,0xF7,0xFB,0xFC,0xFB,0xF7,0xFF,0xFF},/*"x",88*/
 379                  },
 380                  {
 381                          {0xFF,0x3F,0xFF,0xFF,0xFF,0x3F,0xFF,0xFF},
 382                          {0xFF,0xEF,0xEC,0xF3,0xFC,0xFF,0xFF,0xFF},/*"y",89*/
 383                  },
 384                  {
 385                          {0xFF,0xBF,0xBF,0xBF,0xBF,0x3F,0xFF,0xFF},
 386                          {0xFF,0xF7,0xF3,0xF5,0xF6,0xF7,0xFF,0xFF},/*"z",90*/
 387                  },
 388                  {
 389                          {0xFF,0xFF,0x7F,0x83,0xFB,0xFF,0xFF,0xFF},
 390                          {0xFF,0xFF,0xFF,0xE0,0xEF,0xFF,0xFF,0xFF},/*"{",91*/
 391                  },
 392                  {
 393                          {0xFF,0xFF,0xFF,0x01,0xFF,0xFF,0xFF,0xFF},
 394                          {0xFF,0xFF,0xFF,0xE0,0xFF,0xFF,0xFF,0xFF},/*"|",92*/
 395                  },
 396                  {
 397                          {0xFF,0xFF,0xFB,0x83,0x7F,0xFF,0xFF,0xFF},
 398                          {0xFF,0xFF,0xEF,0xE0,0xFF,0xFF,0xFF,0xFF},/*"}",93*/
 399                  },
 400                  {
 401                          {0xFF,0xF7,0xFB,0xFB,0xF7,0xFB,0xFF,0xFF},
 402                          {0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF},/*"~",94*/
 403                  }       
 404          };
 405          
 406          
 407          unsigned char const code nAsciiDot[96][2][6] =  {
 408          
 409          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*" ",0*/
 410          
 411          {0x00,0x00,0xF8,0x00,0x00,0x00,0x00,0x00,0x33,0x00,0x00,0x00},/*"!",1*/
 412          
 413          {0x00,0x08,0x06,0x08,0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*""",2*/
 414          
 415          {0x40,0x40,0xF8,0x40,0xF8,0x40,0x04,0x3F,0x05,0x3F,0x05,0x04},/*"#",3*/
 416          
 417          {0x70,0x88,0xFC,0x08,0x30,0x00,0x18,0x20,0xFF,0x21,0x1E,0x00},/*"$",4*/
 418          
 419          {0xF0,0x98,0x60,0xE0,0x38,0x00,0x00,0x31,0x0E,0x1F,0x33,0x0C},/*"%",5*/
 420          
 421          {0x00,0xF0,0x88,0x70,0x00,0x00,0x1E,0x21,0x26,0x19,0x27,0x20},/*"&",6*/
 422          
C51 COMPILER V9.00   LCD                                                                   05/08/2013 16:47:36 PAGE 8   

 423          {0x10,0x0E,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"'",7*/
 424          
 425          {0x00,0x00,0x00,0xF0,0x0C,0x02,0x00,0x00,0x00,0x0F,0x30,0x40},/*"(",8*/
 426          
 427          {0x00,0x06,0x18,0xE0,0x00,0x00,0x00,0x60,0x18,0x07,0x00,0x00},/*")",9*/
 428          
 429          {0x40,0x80,0xF0,0x80,0x40,0x00,0x02,0x01,0x0F,0x01,0x02,0x00},/*"*",10*/
 430          
 431          {0x00,0x00,0xF0,0x00,0x00,0x00,0x01,0x01,0x1F,0x01,0x01,0x00},/*"+",11*/
 432          
 433          {0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x70,0x00,0x00,0x00,0x00},/*",",12*/
 434          
 435          {0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x01,0x01,0x01,0x00},/*"-",13*/
 436          
 437          {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x30,0x00,0x00,0x00,0x00},/*".",14*/
 438          
 439          {0x00,0x00,0x80,0x70,0x0C,0x00,0x60,0x1C,0x03,0x00,0x00,0x00},/*"/",15*/
 440          
 441          {0xF0,0x08,0x08,0x18,0xE0,0x00,0x1F,0x20,0x20,0x30,0x0F,0x00},/*"0",16*/
 442          
 443          {0x00,0x10,0xF8,0x00,0x00,0x00,0x00,0x20,0x3F,0x20,0x00,0x00},/*"1",17*/
 444          
 445          {0x70,0x08,0x08,0x08,0xF0,0x00,0x30,0x2C,0x22,0x21,0x30,0x00},/*"2",18*/
 446          
 447          {0x30,0x08,0x88,0x88,0x70,0x00,0x18,0x20,0x20,0x31,0x1E,0x00},/*"3",19*/
 448          
 449          {0x00,0x80,0x60,0xF0,0x00,0x00,0x06,0x05,0x24,0x3F,0x24,0x04},/*"4",20*/
 450          
 451          {0xF8,0x08,0x88,0x88,0x08,0x00,0x19,0x21,0x20,0x31,0x1F,0x00},/*"5",21*/
 452          
 453          {0xE0,0x18,0x88,0x98,0x00,0x00,0x0F,0x31,0x20,0x20,0x1F,0x00},/*"6",22*/
 454          
 455          {0x38,0x08,0x08,0xE8,0x18,0x00,0x00,0x00,0x3F,0x00,0x00,0x00},/*"7",23*/
 456          
 457          {0x70,0x88,0x08,0x88,0x70,0x00,0x1E,0x21,0x21,0x21,0x1E,0x00},/*"8",24*/
 458          
 459          {0xF0,0x08,0x08,0x18,0xE0,0x00,0x01,0x32,0x22,0x31,0x0F,0x00},/*"9",25*/
 460          
 461          {0x00,0x00,0xC0,0x00,0x00,0x00,0x00,0x00,0x30,0x00,0x00,0x00},/*":",26*/
 462          
 463          {0x00,0x00,0x80,0x00,0x00,0x00,0x00,0x00,0xE0,0x00,0x00,0x00},/*";",27*/
 464          
 465          {0x00,0x00,0x80,0x60,0x10,0x08,0x00,0x01,0x02,0x0C,0x10,0x20},/*"<",28*/
 466          
 467          {0x40,0x40,0x40,0x40,0x40,0x00,0x04,0x04,0x04,0x04,0x04,0x00},/*"=",29*/
 468          
 469          {0x00,0x08,0x30,0x40,0x80,0x00,0x00,0x20,0x18,0x04,0x02,0x01},/*">",30*/
 470          
 471          {0x70,0x08,0x08,0x88,0x70,0x00,0x00,0x00,0x37,0x01,0x00,0x00},/*"?",31*/
 472          
 473          {0xF0,0x10,0x88,0x78,0xF0,0x00,0x1F,0x20,0x27,0x34,0x0F,0x00},/*"@",32*/
 474          
 475          {0x00,0x80,0x78,0xE0,0x00,0x00,0x20,0x3F,0x02,0x03,0x3E,0x20},/*"A",33*/
 476          
 477          {0x08,0xF8,0x88,0x88,0x70,0x00,0x20,0x3F,0x20,0x20,0x1F,0x00},/*"B",34*/
 478          
 479          {0xF0,0x10,0x08,0x08,0x18,0x00,0x1F,0x20,0x20,0x20,0x10,0x00},/*"C",35*/
 480          
 481          {0x08,0xF8,0x08,0x10,0xE0,0x00,0x20,0x3F,0x20,0x10,0x0F,0x00},/*"D",36*/
 482          
 483          {0x08,0xF8,0x88,0xE8,0x18,0x00,0x20,0x3F,0x20,0x23,0x30,0x00},/*"E",37*/
 484          
C51 COMPILER V9.00   LCD                                                                   05/08/2013 16:47:36 PAGE 9   

 485          {0x08,0xF8,0x88,0xE8,0x18,0x00,0x20,0x3F,0x20,0x03,0x00,0x00},/*"F",38*/
 486          
 487          {0xE0,0x10,0x08,0x08,0x18,0x00,0x0F,0x10,0x20,0x22,0x1E,0x02},/*"G",39*/
 488          
 489          {0x08,0xF8,0x00,0x00,0xF8,0x08,0x20,0x3F,0x01,0x01,0x3F,0x20},/*"H",40*/
 490          
 491          {0x08,0x08,0xF8,0x08,0x08,0x00,0x20,0x20,0x3F,0x20,0x20,0x00},/*"I",41*/
 492          
 493          {0x00,0x08,0x08,0xF8,0x08,0x08,0xC0,0x80,0x80,0x7F,0x00,0x00},/*"J",42*/
 494          
 495          {0x08,0xF8,0x88,0x60,0x18,0x08,0x20,0x3F,0x20,0x07,0x3C,0x20},/*"K",43*/
 496          
 497          {0x08,0xF8,0x08,0x00,0x00,0x00,0x20,0x3F,0x20,0x20,0x20,0x30},/*"L",44*/
 498          
 499          {0xF8,0xF8,0x00,0xF8,0xF8,0x00,0x3F,0x00,0x3F,0x00,0x3F,0x00},/*"M",45*/
 500          
 501          {0x08,0xF8,0xE0,0x08,0xF8,0x08,0x20,0x3F,0x21,0x06,0x3F,0x00},/*"N",46*/
 502          
 503          {0xF0,0x08,0x08,0x18,0xE0,0x00,0x1F,0x20,0x20,0x30,0x0F,0x00},/*"O",47*/
 504          
 505          {0x08,0xF8,0x08,0x08,0xF0,0x00,0x20,0x3F,0x21,0x01,0x00,0x00},/*"P",48*/
 506          
 507          {0xF0,0x08,0x08,0x18,0xE0,0x00,0x0F,0x34,0x2C,0x70,0x7F,0x00},/*"Q",49*/
 508          
 509          {0x08,0xF8,0x88,0x88,0x70,0x00,0x20,0x3F,0x20,0x03,0x3C,0x20},/*"R",50*/
 510          
 511          {0x70,0x88,0x08,0x08,0x18,0x00,0x30,0x20,0x21,0x22,0x1C,0x00},/*"S",51*/
 512          
 513          {0x18,0x08,0xF8,0x08,0x18,0x00,0x00,0x20,0x3F,0x20,0x00,0x00},/*"T",52*/
 514          
 515          {0x08,0xF8,0x00,0x00,0xF8,0x08,0x00,0x1F,0x20,0x20,0x1F,0x00},/*"U",53*/
 516          
 517          {0x08,0xF8,0x00,0x80,0xF8,0x08,0x00,0x03,0x3C,0x0F,0x00,0x00},/*"V",54*/
 518          
 519          {0x78,0x84,0xF8,0xC0,0x78,0x00,0x00,0x3F,0x00,0x3F,0x00,0x00},/*"W",55*/
 520          
 521          {0x08,0x78,0x80,0x78,0x08,0x00,0x20,0x3C,0x03,0x3C,0x20,0x00},/*"X",56*/
 522          
 523          {0x08,0xF8,0x80,0x78,0x08,0x00,0x00,0x20,0x3F,0x20,0x00,0x00},/*"Y",57*/
 524          
 525          {0x18,0x08,0x88,0x78,0x08,0x00,0x20,0x3C,0x23,0x20,0x30,0x00},/*"Z",58*/
 526          
 527          {0x00,0x00,0xFE,0x02,0x02,0x00,0x00,0x00,0x7F,0x40,0x40,0x00},/*"[",59*/
 528          
 529          {0x00,0x38,0xC0,0x00,0x00,0x00,0x00,0x00,0x01,0x1E,0x60,0x00},/*"\",60*/
 530          
 531          {0x00,0x02,0x02,0xFE,0x00,0x00,0x00,0x40,0x40,0x7F,0x00,0x00},/*"]",61*/
 532          
 533          {0x00,0x04,0x02,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"^",62*/
 534          
 535          {0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x80,0x80,0x80,0x80,0x80},/*"_",63*/
 536          
 537          {0x00,0x02,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"`",64*/
 538          
 539          {0x00,0x00,0x80,0x80,0x80,0x00,0x00,0x3D,0x26,0x22,0x3F,0x20},/*"a",65*/
 540          
 541          {0x08,0xF8,0x00,0x80,0x00,0x00,0x00,0x1F,0x21,0x20,0x1F,0x00},/*"b",66*/
 542          
 543          {0x00,0x00,0x80,0x80,0x80,0x00,0x00,0x1F,0x21,0x20,0x21,0x00},/*"c",67*/
 544          
 545          {0x00,0x00,0x80,0x88,0xF8,0x00,0x00,0x1F,0x20,0x20,0x3F,0x20},/*"d",68*/
 546          
C51 COMPILER V9.00   LCD                                                                   05/08/2013 16:47:36 PAGE 10  

 547          {0x00,0x00,0x80,0x80,0x00,0x00,0x00,0x1F,0x22,0x22,0x23,0x00},/*"e",69*/
 548          
 549          {0x00,0x80,0xF0,0x88,0x88,0x18,0x00,0x20,0x3F,0x20,0x20,0x00},/*"f",70*/
 550          
 551          {0x00,0x00,0x80,0x80,0x80,0x80,0x00,0x6B,0x94,0x94,0x93,0x60},/*"g",71*/
 552          
 553          {0x08,0xF8,0x00,0x80,0x80,0x00,0x20,0x3F,0x21,0x00,0x3F,0x20},/*"h",72*/
 554          
 555          {0x00,0x80,0x98,0x00,0x00,0x00,0x00,0x20,0x3F,0x20,0x00,0x00},/*"i",73*/
 556          
 557          {0x00,0x00,0x80,0x98,0x00,0x00,0xC0,0x80,0x80,0x7F,0x00,0x00},/*"j",74*/
 558          
 559          {0x08,0xF8,0x00,0x80,0x80,0x80,0x20,0x3F,0x24,0x06,0x39,0x20},/*"k",75*/
 560          
 561          {0x08,0x08,0xF8,0x00,0x00,0x00,0x20,0x20,0x3F,0x20,0x20,0x00},/*"l",76*/
 562          
 563          {0x80,0x80,0x80,0x80,0x00,0x00,0x3F,0x00,0x3F,0x00,0x3F,0x00},/*"m",77*/
 564          
 565          {0x80,0x80,0x00,0x80,0x80,0x00,0x20,0x3F,0x21,0x00,0x3F,0x20},/*"n",78*/
 566          
 567          {0x00,0x00,0x80,0x80,0x00,0x00,0x00,0x1F,0x20,0x20,0x1F,0x00},/*"o",79*/
 568          
 569          {0x80,0x80,0x80,0x80,0x00,0x00,0x80,0xFF,0xA0,0x20,0x1F,0x00},/*"p",80*/
 570          
 571          {0x00,0x00,0x80,0x80,0x80,0x00,0x00,0x1F,0x20,0xA0,0xFF,0x80},/*"q",81*/
 572          
 573          {0x80,0x80,0x00,0x80,0x80,0x00,0x20,0x3F,0x21,0x00,0x01,0x00},/*"r",82*/
 574          
 575          {0x00,0x00,0x80,0x80,0x80,0x00,0x00,0x23,0x24,0x24,0x39,0x00},/*"s",83*/
 576          
 577          {0x00,0x80,0xE0,0x80,0x00,0x00,0x00,0x00,0x1F,0x20,0x20,0x00},/*"t",84*/
 578          
 579          {0x80,0x80,0x00,0x80,0x80,0x00,0x00,0x3F,0x20,0x20,0x3F,0x20},/*"u",85*/
 580          
 581          {0x80,0x80,0x00,0x00,0x80,0x80,0x00,0x07,0x38,0x1C,0x03,0x00},/*"v",86*/
 582          
 583          {0x80,0x40,0x80,0x00,0x80,0x00,0x03,0x3C,0x03,0x3E,0x03,0x00},/*"w",87*/
 584          
 585          {0x80,0x80,0x00,0x80,0x80,0x00,0x20,0x33,0x0E,0x3B,0x20,0x00},/*"x",88*/
 586          
 587          {0x80,0x80,0x00,0x00,0x80,0x80,0x80,0x87,0x78,0x0C,0x03,0x00},/*"y",89*/
 588          
 589          {0x00,0x80,0x80,0x80,0x80,0x00,0x00,0x30,0x2C,0x23,0x30,0x00},/*"z",90*/
 590          
 591          {0x00,0x00,0x80,0x7E,0x02,0x00,0x00,0x00,0x00,0x3F,0x40,0x00},/*"{",91*/
 592          
 593          //{0x00,0x00,0x00,0xFF,0x00,0x00,0x00,0x00,0x00,0xFF,0x00,0x00},/*"|",92*/
 594          {0x1C,0x22,0x1C,0xC0,0x40,0x40,0x00,0x00,0x00,0x3F,0x02,0x02},/*"未命名文件",DEG AND F*/
 595          
 596          //{0x00,0x02,0x7E,0x80,0x00,0x00,0x00,0x40,0x3F,0x00,0x00,0x00},/*"}",93*/
 597          {0xF8,0xF0,0xE0,0xC0,0x80,0x00,0x0F,0x07,0x03,0x01,0x00,0x00},/*"未命名文件",0 */
 598          
 599          //{0x06,0x01,0x02,0x04,0x04,0x03,0x00,0x00,0x00,0x00,0x00,0x00},/*"~",94*/ 
 600          {0x1C,0x22,0x1C,0x80,0x40,0x40,0x00,0x00,0x00,0x1F,0x20,0x20},/*"未命名文件",DEG AND C */
 601          
 602          {0x00,0x00,0x00,0xFF,0x00,0x00,0x00,0x00,0x00,0xFF,0x00,0x00},/*"|",95*/
 603          
 604          
 605          
 606          };
 607          
 608          U8_T flag_protect_lcd = 0;
C51 COMPILER V9.00   LCD                                                                   05/08/2013 16:47:36 PAGE 11  

 609          
 610          void Lcd_Write_Byte(unsigned char num) //from high to low
 611          {
 612   1              char data i;
 613   1      //      if(flag_protect_lcd) Test[40]++;//return;
 614   1      //      I2C_SCL = 1; 
 615   1              LCD_CS = 0;
 616   1              _nop_();
 617   1              LCD_A0 = 1;
 618   1              _nop_();        
 619   1              for(i = 0;i < 8;i++)
 620   1              {
 621   2                      if(num & 0x80)  LCD_DATA = 1;
 622   2              else            LCD_DATA = 0;
 623   2                      
 624   2                      _nop_();        
 625   2              LCD_CLK = 0;
 626   2                      _nop_();
 627   2                      LCD_CLK = 1;
 628   2                      _nop_();
 629   2      
 630   2              num <<= 1;      
 631   2              }
 632   1              _nop_();
 633   1              LCD_CS = 1;      _nop_();
 634   1              LCD_DATA = 1;
 635   1              _nop_();
 636   1      }
 637          
 638          
 639          void Lcd_Write_Command(unsigned char command) //from high to low
 640          {
 641   1              char data i;
 642   1      /*      if(flag_protect_lcd) Test[40]++;//return;
 643   1              else
 644   1                      Test[41]++;     
 645   1              I2C_SCL = 1; */
 646   1              LCD_CS = 0;
 647   1              _nop_();
 648   1              LCD_A0 = 0;
 649   1              _nop_();        
 650   1              for(i = 0;i < 8;i++)
 651   1              {
 652   2                      if(command & 0x80)      LCD_DATA = 1;
 653   2                      else                    LCD_DATA = 0;
 654   2                              
 655   2                      _nop_();
 656   2              LCD_CLK = 0;
 657   2                      _nop_();
 658   2      
 659   2                      LCD_CLK = 1;
 660   2                      _nop_();
 661   2      
 662   2              command <<= 1;
 663   2              }
 664   1              _nop_();
 665   1              LCD_CS = 1;
 666   1              LCD_DATA = 1;_nop_();   
 667   1              _nop_();
 668   1      }
 669          
 670          
C51 COMPILER V9.00   LCD                                                                   05/08/2013 16:47:36 PAGE 12  

 671          
 672          void Lcd_Write_Char(unsigned char row,unsigned char line,unsigned char num,char mode) // row: 0 - 4 , line
             -: 0 - 21
 673          {
 674   1      
 675   1              unsigned char data loop; 
 676   1              unsigned char data index = num - ' ';
 677   1              
 678   1              Lcd_Write_Command(0x07);        
 679   1              Lcd_Set_X_Addr((line + 1) * 6);
 680   1              Lcd_Set_Y_Addr(row * 2);
 681   1              for(loop = 0;loop < 6;loop++) 
 682   1                      if(mode == 1)   Lcd_Write_Byte(nAsciiDot[index][0][loop]);  // Normal
 683   1                      else  Lcd_Write_Byte(~nAsciiDot[index][0][loop]);                       // inverse
 684   1              Lcd_Set_X_Addr((line + 1) * 6);
 685   1              Lcd_Set_Y_Addr(row * 2+1);
 686   1              for(loop = 0;loop < 6;loop++) 
 687   1                      if(mode == 1)   Lcd_Write_Byte(nAsciiDot[index][1][loop]);  // Normal
 688   1                      else Lcd_Write_Byte(~nAsciiDot[index][1][loop]);                        // inverse
 689   1              Lcd_Write_Command(0x06);
 690   1      
 691   1      }
 692          
 693          void Lcd_Set_Fuction(char mode)
 694          {
 695   1              unsigned char fuction;
 696   1              fuction = 0x38 + mode;//0x20 + mode;
 697   1              Lcd_Write_Command(fuction);
 698   1      }
 699          
 700          void Lcd_Set_Y_Addr(unsigned char page)// 0 1 0 0        page 0 - 9
 701          {
 702   1              unsigned char addr;
 703   1              Lcd_Set_Fuction(0);
 704   1              addr = 0x40 + page;
 705   1              Lcd_Write_Command(addr);
 706   1      }
 707          
 708          void Lcd_Set_X_Addr(unsigned char line)// 1 1 1 0/1        page 0 - 129
 709          {
 710   1              unsigned char addr;
 711   1              unsigned char line_low;
 712   1              unsigned char line_high;
 713   1              Lcd_Set_Fuction(0);
 714   1              line_low = line & 0x0f;
 715   1              line = line >> 4;
 716   1              line_high = line; 
 717   1              addr = 0xe0 + line_low; //low
 718   1              Lcd_Write_Command(addr);
 719   1              addr = 0xf0 + line_high; //high
 720   1              Lcd_Write_Command(addr);
 721   1      }
 722          
 723          
 724          void Lcd_Initial(void)
 725          {
 726   1              LCD_RESET = 0;
 727   1              DELAY_Us(1000);
 728   1              LCD_RESET = 1;
 729   1              DELAY_Us(100);
 730   1      
 731   1              
C51 COMPILER V9.00   LCD                                                                   05/08/2013 16:47:36 PAGE 13  

 732   1              Lcd_Set_Fuction(1); // 0x21              
 733   1              //DELAY_Us(10);
 734   1              Lcd_Write_Command(CMD_SET_BIAS);  //DELAY_Us(10);
 735   1              Lcd_Write_Command(CMD_SET_V0);   //DELAY_Us(10);
 736   1              Lcd_Write_Command(CMD_DISPLAY_CONFIG); //DELAY_Us(10);
 737   1              
 738   1              Lcd_Set_Fuction(0); //DELAY_Us(10); // 0x20
 739   1              Lcd_Write_Command(CMD_SET_V0Range_HIGH);  //DELAY_Us(10);  
 740   1              Lcd_Write_Command(CMD_DISPLAT_NORMAL); //DELAY_Us(10);
 741   1              Lcd_Set_X_Addr(0); //DELAY_Us(10); //0xf0 0xe0
 742   1              Lcd_Set_Y_Addr(0); //DELAY_Us(10); //0x40       
 743   1      
 744   1              Lcd_All_Off();
 745   1              
 746   1      }
 747          
 748          void Lcd_All_Off(void)
 749          {
 750   1              unsigned int i;
 751   1              Lcd_Write_Command(0x07);
 752   1              for(i = 0;i < 130*80;i++)       
 753   1              {
 754   2                      Lcd_Write_Byte(0x00);
 755   2              }
 756   1              Lcd_Write_Command(0x06);
 757   1      }
 758          
 759          void Lcd_Show_String(U8_T pos_x, U8_T pos_y, S8_T* str,U8_T mode,U8_T format)
 760          {
 761   1              U8_T loop;      
 762   1              U8_T len = format & 0x7f; /* the higest bit is for selecting capital or uncial, the real lenght is "forma
             -t & 0x7f" */
 763   1              U8_T str_len;
 764   1              S8_T far tempstr[21];
 765   1              if(len > 21)    len = 21;
 766   1              if(strlen(str) > 21) str_len = 21;
 767   1              else    str_len = strlen(str);
 768   1              for(loop = 0;loop < strlen(str);loop++)
 769   1              { /* check the higheset bit, it is for capital or uncial */
 770   2                      if(format & 0x80)       tempstr[loop] = (S8_T)toupper(str[loop]); /* capital */
 771   2                      else tempstr[loop] = str[loop]; /* uncial */
 772   2              }
 773   1      
 774   1              /* if the real len is bigger than the strings, using space to fill the residual area*/
 775   1              if(len > strlen(str))
 776   1              {       
 777   2                              /* fill space */
 778   2                      for(loop = strlen(str);loop < len;loop++)
 779   2                      {
 780   3                              Lcd_Write_Char(pos_x,pos_y + loop,' ',mode);
 781   3                      }       
 782   2                              /* copy read data to LCD buffer */
 783   2                      for(loop = 0;loop < strlen(str);loop++)
 784   2                      {
 785   3                              Lcd_Write_Char(pos_x,pos_y + loop,tempstr[loop],mode);          
 786   3                      }
 787   2              }
 788   1              /* if the real len is less than the string, cut the string */
 789   1              /* if len is 0, using string len */
 790   1              else
 791   1              {       
 792   2                      if(len == 0)    len = strlen(str);      
C51 COMPILER V9.00   LCD                                                                   05/08/2013 16:47:36 PAGE 14  

 793   2                      for(loop = 0;loop < len;loop++)
 794   2                      {
 795   3                              Lcd_Write_Char(pos_x,pos_y + loop,tempstr[loop],mode);
 796   3                      }
 797   2              }
 798   1      }
 799          
 800          
 801          
 802          void Lcd_Show_Data(char pos_x,char pos_y,unsigned int number,char dot,char mode) //,char div, bool signed)
 803          {
 804   1              char  loop = 0;
 805   1              char  num[5];
 806   1              char  length;
 807   1              char  by_x,by_y;
 808   1      
 809   1              by_x = pos_x;
 810   1              by_y = pos_y;   
 811   1      
 812   1              //number = number / div;
 813   1      
 814   1              if(number >= 1000)      length = 4;
 815   1              else if(number >= 100)  length = 3;
 816   1              else if(number >= 10)   length = 2;
 817   1              else length = 1;
 818   1      
 819   1              if((length > 1) && (dot != 0)) 
 820   1              {
 821   2                      length ++;      
 822   2                      num[dot] = '.';
 823   2                      num[4] = number / 1000;         number = number % 1000;
 824   2                      switch(dot)
 825   2                      {
 826   3                              case 3:
 827   3                                              num[2] = number / 100;          number = number % 100;
 828   3                                              num[1] = number / 10;           number = number % 10;
 829   3                                              num[0] = number;
 830   3                                              break;
 831   3                              case 2:
 832   3                                              num[3] = number / 100;          number = number % 100;
 833   3                                              num[1] = number / 10;           number = number % 10;
 834   3                                              num[0] = number;
 835   3                                              break;
 836   3                              case 1:
 837   3                                              num[3] = number / 100;          number = number % 100;
 838   3                                              num[2] = number / 10;           number = number % 10;
 839   3                                              num[0] = number;
 840   3                                              break;
 841   3                      }
 842   2      
 843   2              }
 844   1              else
 845   1              {
 846   2                      num[3] = number / 1000;         number = number % 1000;
 847   2                      num[2] = number / 100;          number = number % 100;
 848   2                      num[1] = number / 10;           number = number % 10;
 849   2                      num[0] = number;
 850   2              }       
 851   1      
 852   1      //      Lcd_Write_Command(0x07);        
 853   1              for(loop = length - 1;loop >= 0;loop--)
 854   1              {
C51 COMPILER V9.00   LCD                                                                   05/08/2013 16:47:36 PAGE 15  

 855   2                      if(num[loop] == '.')    Lcd_Write_Char(by_x,by_y,'.',mode);
 856   2                      else
 857   2                      Lcd_Write_Char(by_x,by_y,aby_Char_Table[num[loop]],mode);
 858   2                      by_y ++;
 859   2                      if(by_y >= 21)
 860   2                      {
 861   3                              by_y = 0;
 862   3                              by_x ++;
 863   3                              if(by_x >= 5)   by_x = 0;
 864   3                      }
 865   2              }
 866   1              if(length < 4)
 867   1              for(loop = 4;loop >= length;loop--)
 868   1              {
 869   2                       Lcd_Write_Char(by_x,by_y - length + loop,' ',mode);
 870   2              }       
 871   1      //      Lcd_Write_Command(0x06);
 872   1                      
 873   1      }
 874          
 875          char message[200];
 876          char scroll_message_length;
 877          
 878          bit scrolling_flag = TRUE;
 879          
 880          void start_scrolling(void)
 881          {
 882   1              scrolling_flag = TRUE;
 883   1      }
 884          
 885          void stop_scrolling(void)
 886          {
 887   1              scrolling_flag = FALSE;
 888   1      }
 889          
 890          char time[] = "2012-09-19 17:16";
 891          void get_time_text(void)
 892          {
 893   1      
 894   1              time[2] =  RTC.Clk.year / 10 + '0';
 895   1              time[3] =  RTC.Clk.year % 10 + '0';
 896   1              time[4] = '-';
 897   1              time[5] =  RTC.Clk.mon / 10 + '0';
 898   1              time[6] =  RTC.Clk.mon % 10 + '0';
 899   1              time[7] = '-';
 900   1              time[8] =  RTC.Clk.day / 10 + '0';
 901   1              time[9] =  RTC.Clk.day % 10 + '0';
 902   1              time[11] =  RTC.Clk.hour / 10 + '0';
 903   1              time[12] =  RTC.Clk.hour % 10 + '0';
 904   1              time[14] =  RTC.Clk.min / 10 + '0';
 905   1              time[15] =  RTC.Clk.min % 10 + '0';
 906   1      
 907   1      }
 908          
 909          U8_T const code network_status_text[] = "  NETWORK:";
 910          U8_T const code main_net_status_text[] = " Main net:";
 911          U8_T const code sub_net_status_text[] = " Subnet:";
 912          U8_T const code net_status_ok_text[] = "OK";
 913          U8_T const code net_status_dead_text[] = "Dead";
 914          U8_T const code net_offline_text[] = "Offline";
 915          U8_T const code alarm_text[] = "  ALARM:";
 916          
C51 COMPILER V9.00   LCD                                                                   05/08/2013 16:47:36 PAGE 16  

 917          void update_message_context(void)
 918          {
 919   1              U8_T data length;
 920   1      
 921   1              if(scrolling_flag == 1)
 922   1              {         
 923   2              scroll_message_length = 0;
 924   2      
 925   2              length = sizeof(time) - 1;
 926   2              get_time_text();
 927   2              memcpy(message + scroll_message_length, time, length);
 928   2              scroll_message_length += length;
 929   2      
 930   2      // Network
 931   2              length = sizeof(network_status_text) - 1;
 932   2              memcpy(message + scroll_message_length, network_status_text, length);
 933   2              scroll_message_length += length;
 934   2              // main net status
 935   2              length = sizeof(main_net_status_text) - 1;
 936   2              memcpy(message + scroll_message_length, main_net_status_text, length);
 937   2              scroll_message_length += length;
 938   2              //if(main_net_status_ctr)
 939   2              {
 940   3                      length = sizeof(net_status_ok_text) - 1;
 941   3                      memcpy(message + scroll_message_length, net_status_ok_text, length);
 942   3                      scroll_message_length += length;
 943   3              }
 944   2              /*else
 945   2              {
 946   2                      length = sizeof(net_status_dead_text) - 1;
 947   2                      memcpy(message + scroll_message_length, net_status_dead_text, length);
 948   2                      scroll_message_length += length;
 949   2              }*/
 950   2              // sub net status
 951   2              length = sizeof(sub_net_status_text) - 1;
 952   2              memcpy(message + scroll_message_length, sub_net_status_text, length);
 953   2              scroll_message_length += length;
 954   2              //if(db_ctr == current_online_ctr)
 955   2              {
 956   3                      length = sizeof(net_status_ok_text) - 1;
 957   3                      memcpy(message + scroll_message_length, net_status_ok_text, length);
 958   3                      scroll_message_length += length;
 959   3              }
 960   2              /*else
 961   2              {
 962   2                      U8_T data i, id_temp;
 963   2                      for(i = 1; i < db_ctr; i++)
 964   2                      {
 965   2                              id_temp = read_eeprom(SCAN_DB_START_ADDR + 5*i);
 966   2                              if((current_online[id_temp / 8] & (1 << (id_temp % 8))) == 0x00)
 967   2                              {
 968   2                                      strcpy(text, external_text);
 969   2                                      itoa(id_temp, int_text);
 970   2      //                              sprintf(int_text, "%u", id_temp);
 971   2                                      strcat(text, int_text);
 972   2                                      strcat(text, " ");
 973   2      
 974   2                                      length = strlen(text);
 975   2                                      memcpy(message + scroll_message_length, text, length);
 976   2                                      scroll_message_length += length;
 977   2                              }
 978   2                      }
C51 COMPILER V9.00   LCD                                                                   05/08/2013 16:47:36 PAGE 17  

 979   2      
 980   2                      length = sizeof(net_offline_text) - 1;
 981   2                      memcpy(message + scroll_message_length, net_offline_text, length);
 982   2                      scroll_message_length += length;
 983   2              }  */
 984   2      
 985   2      // Alarm
 986   2              length = sizeof(alarm_text) - 1;
 987   2              memcpy(message + scroll_message_length, alarm_text, length);
 988   2              scroll_message_length += length;
 989   2      
 990   2      
 991   2      // SPACE
 992   2              length = 3;
 993   2              memcpy(message + scroll_message_length, "   ", length);
 994   2              scroll_message_length += length;
 995   2              }
 996   1      
 997   1      }
 998          
 999          
1000          void display_character_with_start_bit(U8_T row, U8_T start_line, U8_T start_bit, U8_T end_bit, U8_T c, U8_
             -T disp_mode)
1001          {
1002   1              U8_T data i;
1003   1              U8_T data index = c - ' ';
1004   1      
1005   1              if(start_line >= 130)
1006   1                      return;
1007   1              Lcd_Write_Command(0x07);        
1008   1              Lcd_Set_X_Addr(start_line);
1009   1              Lcd_Set_Y_Addr(row * 2);
1010   1              for(i = start_bit; i < end_bit; i++)
1011   1              { 
1012   2                      if(disp_mode == NORMAL)
1013   2                              Lcd_Write_Byte(Dot8_16[index][0][i]);
1014   2                      else
1015   2                              Lcd_Write_Byte(~Dot8_16[index][0][i]);
1016   2              }
1017   1      
1018   1              
1019   1              Lcd_Set_X_Addr(start_line);
1020   1              Lcd_Set_Y_Addr(row * 2 + 1);
1021   1              for(i = start_bit; i < end_bit; i++)
1022   1              { 
1023   2                      if(disp_mode == NORMAL)
1024   2                              Lcd_Write_Byte(Dot8_16[index][1][i]);
1025   2                      else
1026   2                              Lcd_Write_Byte(~Dot8_16[index][1][i]);
1027   2              }
1028   1              Lcd_Write_Command(0x06);
1029   1      }
1030          
1031          void scrolling_message(void)
1032          {
1033   1              char data i, disp_value, byte_index;
1034   1              static char start_bit = 0;
1035   1              static char start_byte = 0;
1036   1      
1037   1              if(scrolling_flag != FALSE)
1038   1              {//     return;
1039   2      
C51 COMPILER V9.00   LCD                                                                   05/08/2013 16:47:36 PAGE 18  

1040   2              byte_index = start_byte;
1041   2      
1042   2              disp_value = message[byte_index++];
1043   2              byte_index %= scroll_message_length;
1044   2              display_character_with_start_bit(4, 0, start_bit, 8, disp_value, NORMAL);
1045   2              if(start_bit < 7)
1046   2              {
1047   3                      for(i = 1; i < 16; i++)
1048   3                      {
1049   4                              disp_value = message[byte_index++];
1050   4                              byte_index %= scroll_message_length;
1051   4                              display_character_with_start_bit(4, 8 * i - start_bit, 0, 8, disp_value, NORMAL);
1052   4                      }
1053   3              
1054   3                      disp_value = message[byte_index++];
1055   3                      byte_index %= scroll_message_length;
1056   3                      display_character_with_start_bit(4, 8 * i - start_bit, 0, 4 + start_bit, disp_value, NORMAL);
1057   3              }
1058   2              else // if(start_bit == 7)
1059   2              {
1060   3                      for(i = 1; i < 17; i++)
1061   3                      {
1062   4                              disp_value = message[byte_index++];
1063   4                              byte_index %= scroll_message_length;
1064   4                              display_character_with_start_bit(4, 8 * i - start_bit, 0, 8, disp_value, NORMAL);
1065   4                      }
1066   3              
1067   3                      disp_value = message[byte_index++];
1068   3                      byte_index %= scroll_message_length;
1069   3                      display_character_with_start_bit(4, 8 * i - start_bit, 0, start_bit - 2, disp_value, NORMAL);
1070   3              } 
1071   2      
1072   2              start_bit++;
1073   2              if(start_bit >= 8)
1074   2              {
1075   3                      start_bit = 0;
1076   3                      start_byte++;
1077   3                      start_byte %= scroll_message_length;
1078   3              }
1079   2              }
1080   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   2807    ----
   CONSTANT SIZE    =   2742    ----
   XDATA SIZE       =    221      35
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      10
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =     21    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
